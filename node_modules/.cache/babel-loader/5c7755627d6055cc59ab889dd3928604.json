{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amardeep\\\\tarek_project\\\\ftw-product\\\\src\\\\containers\\\\ProfileSettingsPage\\\\ProfileSettingsForm\\\\ProfileSettingsForm.js\";\nimport React, { Component } from 'react';\nimport { bool, string } from 'prop-types';\nimport { compose } from 'redux';\nimport { Field, Form as FinalForm } from 'react-final-form';\nimport isEqual from 'lodash/isEqual';\nimport classNames from 'classnames';\nimport { FormattedMessage, injectIntl, intlShape } from '../../../util/reactIntl';\nimport { ensureCurrentUser } from '../../../util/data';\nimport { propTypes } from '../../../util/types';\nimport * as validators from '../../../util/validators';\nimport { isUploadImageOverLimitError } from '../../../util/errors';\nimport { Form, Avatar, Button, ImageFromFile, IconSpinner, FieldTextInput } from '../../../components';\nimport css from './ProfileSettingsForm.module.css';\nconst ACCEPT_IMAGES = 'image/*';\nconst UPLOAD_CHANGE_DELAY = 2000; // Show spinner so that browser has time to load img srcset\n\nclass ProfileSettingsFormComponent extends Component {\n  constructor(props) {\n    super(props);\n    this.uploadDelayTimeoutId = null;\n    this.state = {\n      uploadDelay: false\n    };\n    this.submittedValues = {};\n  }\n\n  componentDidUpdate(prevProps) {\n    // Upload delay is additional time window where Avatar is added to the DOM,\n    // but not yet visible (time to load image URL from srcset)\n    if (prevProps.uploadInProgress && !this.props.uploadInProgress) {\n      this.setState({\n        uploadDelay: true\n      });\n      this.uploadDelayTimeoutId = window.setTimeout(() => {\n        this.setState({\n          uploadDelay: false\n        });\n      }, UPLOAD_CHANGE_DELAY);\n    }\n  }\n\n  componentWillUnmount() {\n    window.clearTimeout(this.uploadDelayTimeoutId);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(FinalForm, Object.assign({}, this.props, {\n      render: fieldRenderProps => {\n        const {\n          className,\n          currentUser,\n          handleSubmit,\n          intl,\n          invalid,\n          onImageUpload,\n          pristine,\n          profileImage,\n          rootClassName,\n          updateInProgress,\n          updateProfileError,\n          uploadImageError,\n          uploadInProgress,\n          form,\n          values\n        } = fieldRenderProps;\n        const user = ensureCurrentUser(currentUser); // First name\n\n        const firstNameLabel = intl.formatMessage({\n          id: 'ProfileSettingsForm.firstNameLabel'\n        });\n        const firstNamePlaceholder = intl.formatMessage({\n          id: 'ProfileSettingsForm.firstNamePlaceholder'\n        });\n        const firstNameRequiredMessage = intl.formatMessage({\n          id: 'ProfileSettingsForm.firstNameRequired'\n        });\n        const firstNameRequired = validators.required(firstNameRequiredMessage); // Last name\n\n        const lastNameLabel = intl.formatMessage({\n          id: 'ProfileSettingsForm.lastNameLabel'\n        });\n        const lastNamePlaceholder = intl.formatMessage({\n          id: 'ProfileSettingsForm.lastNamePlaceholder'\n        });\n        const lastNameRequiredMessage = intl.formatMessage({\n          id: 'ProfileSettingsForm.lastNameRequired'\n        });\n        const lastNameRequired = validators.required(lastNameRequiredMessage); // Bio\n\n        const bioLabel = intl.formatMessage({\n          id: 'ProfileSettingsForm.bioLabel'\n        });\n        const bioPlaceholder = intl.formatMessage({\n          id: 'ProfileSettingsForm.bioPlaceholder'\n        });\n        const uploadingOverlay = uploadInProgress || this.state.uploadDelay ? /*#__PURE__*/React.createElement(\"div\", {\n          className: css.uploadingImageOverlay,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(IconSpinner, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 17\n          }\n        })) : null;\n        const hasUploadError = !!uploadImageError && !uploadInProgress;\n        const errorClasses = classNames({\n          [css.avatarUploadError]: hasUploadError\n        });\n        const transientUserProfileImage = profileImage.uploadedImage || user.profileImage;\n        const transientUser = { ...user,\n          profileImage: transientUserProfileImage\n        }; // Ensure that file exists if imageFromFile is used\n\n        const fileExists = !!profileImage.file;\n        const fileUploadInProgress = uploadInProgress && fileExists;\n        const delayAfterUpload = profileImage.imageId && this.state.uploadDelay;\n        const imageFromFile = fileExists && (fileUploadInProgress || delayAfterUpload) ? /*#__PURE__*/React.createElement(ImageFromFile, {\n          id: profileImage.id,\n          className: errorClasses,\n          rootClassName: css.uploadingImage,\n          aspectRatioClassName: css.squareAspectRatio,\n          file: profileImage.file,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 15\n          }\n        }, uploadingOverlay) : null; // Avatar is rendered in hidden during the upload delay\n        // Upload delay smoothes image change process:\n        // responsive img has time to load srcset stuff before it is shown to user.\n\n        const avatarClasses = classNames(errorClasses, css.avatar, {\n          [css.avatarInvisible]: this.state.uploadDelay\n        });\n        const avatarComponent = !fileUploadInProgress && profileImage.imageId ? /*#__PURE__*/React.createElement(Avatar, {\n          className: avatarClasses,\n          renderSizes: \"(max-width: 767px) 96px, 240px\",\n          user: transientUser,\n          disableProfileLink: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 15\n          }\n        }) : null;\n        const chooseAvatarLabel = profileImage.imageId || fileUploadInProgress ? /*#__PURE__*/React.createElement(\"div\", {\n          className: css.avatarContainer,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 15\n          }\n        }, imageFromFile, avatarComponent, /*#__PURE__*/React.createElement(\"div\", {\n          className: css.changeAvatar,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.changeAvatar\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 19\n          }\n        }))) : /*#__PURE__*/React.createElement(\"div\", {\n          className: css.avatarPlaceholder,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: css.avatarPlaceholderText,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.addYourProfilePicture\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 19\n          }\n        })), /*#__PURE__*/React.createElement(\"div\", {\n          className: css.avatarPlaceholderTextMobile,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.addYourProfilePictureMobile\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 19\n          }\n        })));\n        const submitError = updateProfileError ? /*#__PURE__*/React.createElement(\"div\", {\n          className: css.error,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.updateProfileFailed\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 15\n          }\n        })) : null;\n        const classes = classNames(rootClassName || css.root, className);\n        const submitInProgress = updateInProgress;\n        const submittedOnce = Object.keys(this.submittedValues).length > 0;\n        const pristineSinceLastSubmit = submittedOnce && isEqual(values, this.submittedValues);\n        const submitDisabled = invalid || pristine || pristineSinceLastSubmit || uploadInProgress || submitInProgress;\n        return /*#__PURE__*/React.createElement(Form, {\n          className: classes,\n          onSubmit: e => {\n            this.submittedValues = values;\n            handleSubmit(e);\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: css.sectionContainer,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"h3\", {\n          className: css.sectionTitle,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.yourProfilePicture\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 19\n          }\n        })), /*#__PURE__*/React.createElement(Field, {\n          accept: ACCEPT_IMAGES,\n          id: \"profileImage\",\n          name: \"profileImage\",\n          label: chooseAvatarLabel,\n          type: \"file\",\n          form: null,\n          uploadImageError: uploadImageError,\n          disabled: uploadInProgress,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 17\n          }\n        }, fieldProps => {\n          const {\n            accept,\n            id,\n            input,\n            label,\n            disabled,\n            uploadImageError\n          } = fieldProps;\n          const {\n            name,\n            type\n          } = input;\n\n          const onChange = e => {\n            const file = e.target.files[0];\n            form.change(`profileImage`, file);\n            form.blur(`profileImage`);\n\n            if (file != null) {\n              const tempId = `${file.name}_${Date.now()}`;\n              onImageUpload({\n                id: tempId,\n                file\n              });\n            }\n          };\n\n          let error = null;\n\n          if (isUploadImageOverLimitError(uploadImageError)) {\n            error = /*#__PURE__*/React.createElement(\"div\", {\n              className: css.error,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 25\n              }\n            }, /*#__PURE__*/React.createElement(FormattedMessage, {\n              id: \"ProfileSettingsForm.imageUploadFailedFileTooLarge\",\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 27\n              }\n            }));\n          } else if (uploadImageError) {\n            error = /*#__PURE__*/React.createElement(\"div\", {\n              className: css.error,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 25\n              }\n            }, /*#__PURE__*/React.createElement(FormattedMessage, {\n              id: \"ProfileSettingsForm.imageUploadFailed\",\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 27\n              }\n            }));\n          }\n\n          return /*#__PURE__*/React.createElement(\"div\", {\n            className: css.uploadAvatarWrapper,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 23\n            }\n          }, /*#__PURE__*/React.createElement(\"label\", {\n            className: css.label,\n            htmlFor: id,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 25\n            }\n          }, label), /*#__PURE__*/React.createElement(\"input\", {\n            accept: accept,\n            id: id,\n            name: name,\n            className: css.uploadAvatarInput,\n            disabled: disabled,\n            onChange: onChange,\n            type: type,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 25\n            }\n          }), error);\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          className: css.tip,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.tip\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 19\n          }\n        })), /*#__PURE__*/React.createElement(\"div\", {\n          className: css.fileInfo,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.fileInfo\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 19\n          }\n        }))), /*#__PURE__*/React.createElement(\"div\", {\n          className: css.sectionContainer,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"h3\", {\n          className: css.sectionTitle,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.yourName\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 19\n          }\n        })), /*#__PURE__*/React.createElement(\"div\", {\n          className: css.nameContainer,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FieldTextInput, {\n          className: css.firstName,\n          type: \"text\",\n          id: \"firstName\",\n          name: \"firstName\",\n          label: firstNameLabel,\n          placeholder: firstNamePlaceholder,\n          validate: firstNameRequired,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 19\n          }\n        }), /*#__PURE__*/React.createElement(FieldTextInput, {\n          className: css.lastName,\n          type: \"text\",\n          id: \"lastName\",\n          name: \"lastName\",\n          label: lastNameLabel,\n          placeholder: lastNamePlaceholder,\n          validate: lastNameRequired,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 19\n          }\n        }))), /*#__PURE__*/React.createElement(\"div\", {\n          className: classNames(css.sectionContainer, css.lastSection),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"h3\", {\n          className: css.sectionTitle,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.bioHeading\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 19\n          }\n        })), /*#__PURE__*/React.createElement(FieldTextInput, {\n          type: \"textarea\",\n          id: \"bio\",\n          name: \"bio\",\n          label: bioLabel,\n          placeholder: bioPlaceholder,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          className: css.bioInfo,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.bioInfo\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 19\n          }\n        }))), submitError, /*#__PURE__*/React.createElement(Button, {\n          className: css.submitButton,\n          type: \"submit\",\n          inProgress: submitInProgress,\n          disabled: submitDisabled,\n          ready: pristineSinceLastSubmit,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(FormattedMessage, {\n          id: \"ProfileSettingsForm.saveChanges\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 17\n          }\n        })));\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 7\n      }\n    }));\n  }\n\n}\n\nProfileSettingsFormComponent.defaultProps = {\n  rootClassName: null,\n  className: null,\n  uploadImageError: null,\n  updateProfileError: null,\n  updateProfileReady: false\n};\nProfileSettingsFormComponent.propTypes = {\n  rootClassName: string,\n  className: string,\n  uploadImageError: propTypes.error,\n  uploadInProgress: bool.isRequired,\n  updateInProgress: bool.isRequired,\n  updateProfileError: propTypes.error,\n  updateProfileReady: bool,\n  // from injectIntl\n  intl: intlShape.isRequired\n};\nconst ProfileSettingsForm = compose(injectIntl)(ProfileSettingsFormComponent);\nProfileSettingsForm.displayName = 'ProfileSettingsForm';\nexport default ProfileSettingsForm;","map":{"version":3,"sources":["D:/Amardeep/tarek_project/ftw-product/src/containers/ProfileSettingsPage/ProfileSettingsForm/ProfileSettingsForm.js"],"names":["React","Component","bool","string","compose","Field","Form","FinalForm","isEqual","classNames","FormattedMessage","injectIntl","intlShape","ensureCurrentUser","propTypes","validators","isUploadImageOverLimitError","Avatar","Button","ImageFromFile","IconSpinner","FieldTextInput","css","ACCEPT_IMAGES","UPLOAD_CHANGE_DELAY","ProfileSettingsFormComponent","constructor","props","uploadDelayTimeoutId","state","uploadDelay","submittedValues","componentDidUpdate","prevProps","uploadInProgress","setState","window","setTimeout","componentWillUnmount","clearTimeout","render","fieldRenderProps","className","currentUser","handleSubmit","intl","invalid","onImageUpload","pristine","profileImage","rootClassName","updateInProgress","updateProfileError","uploadImageError","form","values","user","firstNameLabel","formatMessage","id","firstNamePlaceholder","firstNameRequiredMessage","firstNameRequired","required","lastNameLabel","lastNamePlaceholder","lastNameRequiredMessage","lastNameRequired","bioLabel","bioPlaceholder","uploadingOverlay","uploadingImageOverlay","hasUploadError","errorClasses","avatarUploadError","transientUserProfileImage","uploadedImage","transientUser","fileExists","file","fileUploadInProgress","delayAfterUpload","imageId","imageFromFile","uploadingImage","squareAspectRatio","avatarClasses","avatar","avatarInvisible","avatarComponent","chooseAvatarLabel","avatarContainer","changeAvatar","avatarPlaceholder","avatarPlaceholderText","avatarPlaceholderTextMobile","submitError","error","classes","root","submitInProgress","submittedOnce","Object","keys","length","pristineSinceLastSubmit","submitDisabled","e","sectionContainer","sectionTitle","fieldProps","accept","input","label","disabled","name","type","onChange","target","files","change","blur","tempId","Date","now","uploadAvatarWrapper","uploadAvatarInput","tip","fileInfo","nameContainer","firstName","lastName","lastSection","bioInfo","submitButton","defaultProps","updateProfileReady","isRequired","ProfileSettingsForm","displayName"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { bool, string } from 'prop-types';\r\nimport { compose } from 'redux';\r\nimport { Field, Form as FinalForm } from 'react-final-form';\r\nimport isEqual from 'lodash/isEqual';\r\nimport classNames from 'classnames';\r\n\r\nimport { FormattedMessage, injectIntl, intlShape } from '../../../util/reactIntl';\r\nimport { ensureCurrentUser } from '../../../util/data';\r\nimport { propTypes } from '../../../util/types';\r\nimport * as validators from '../../../util/validators';\r\nimport { isUploadImageOverLimitError } from '../../../util/errors';\r\n\r\nimport {\r\n  Form,\r\n  Avatar,\r\n  Button,\r\n  ImageFromFile,\r\n  IconSpinner,\r\n  FieldTextInput,\r\n} from '../../../components';\r\n\r\nimport css from './ProfileSettingsForm.module.css';\r\n\r\nconst ACCEPT_IMAGES = 'image/*';\r\nconst UPLOAD_CHANGE_DELAY = 2000; // Show spinner so that browser has time to load img srcset\r\n\r\nclass ProfileSettingsFormComponent extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.uploadDelayTimeoutId = null;\r\n    this.state = { uploadDelay: false };\r\n    this.submittedValues = {};\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    // Upload delay is additional time window where Avatar is added to the DOM,\r\n    // but not yet visible (time to load image URL from srcset)\r\n    if (prevProps.uploadInProgress && !this.props.uploadInProgress) {\r\n      this.setState({ uploadDelay: true });\r\n      this.uploadDelayTimeoutId = window.setTimeout(() => {\r\n        this.setState({ uploadDelay: false });\r\n      }, UPLOAD_CHANGE_DELAY);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.clearTimeout(this.uploadDelayTimeoutId);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <FinalForm\r\n        {...this.props}\r\n        render={fieldRenderProps => {\r\n          const {\r\n            className,\r\n            currentUser,\r\n            handleSubmit,\r\n            intl,\r\n            invalid,\r\n            onImageUpload,\r\n            pristine,\r\n            profileImage,\r\n            rootClassName,\r\n            updateInProgress,\r\n            updateProfileError,\r\n            uploadImageError,\r\n            uploadInProgress,\r\n            form,\r\n            values,\r\n          } = fieldRenderProps;\r\n\r\n          const user = ensureCurrentUser(currentUser);\r\n\r\n          // First name\r\n          const firstNameLabel = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.firstNameLabel',\r\n          });\r\n          const firstNamePlaceholder = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.firstNamePlaceholder',\r\n          });\r\n          const firstNameRequiredMessage = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.firstNameRequired',\r\n          });\r\n          const firstNameRequired = validators.required(firstNameRequiredMessage);\r\n\r\n          // Last name\r\n          const lastNameLabel = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.lastNameLabel',\r\n          });\r\n          const lastNamePlaceholder = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.lastNamePlaceholder',\r\n          });\r\n          const lastNameRequiredMessage = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.lastNameRequired',\r\n          });\r\n          const lastNameRequired = validators.required(lastNameRequiredMessage);\r\n\r\n          // Bio\r\n          const bioLabel = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.bioLabel',\r\n          });\r\n          const bioPlaceholder = intl.formatMessage({\r\n            id: 'ProfileSettingsForm.bioPlaceholder',\r\n          });\r\n\r\n          const uploadingOverlay =\r\n            uploadInProgress || this.state.uploadDelay ? (\r\n              <div className={css.uploadingImageOverlay}>\r\n                <IconSpinner />\r\n              </div>\r\n            ) : null;\r\n\r\n          const hasUploadError = !!uploadImageError && !uploadInProgress;\r\n          const errorClasses = classNames({ [css.avatarUploadError]: hasUploadError });\r\n          const transientUserProfileImage = profileImage.uploadedImage || user.profileImage;\r\n          const transientUser = { ...user, profileImage: transientUserProfileImage };\r\n\r\n          // Ensure that file exists if imageFromFile is used\r\n          const fileExists = !!profileImage.file;\r\n          const fileUploadInProgress = uploadInProgress && fileExists;\r\n          const delayAfterUpload = profileImage.imageId && this.state.uploadDelay;\r\n          const imageFromFile =\r\n            fileExists && (fileUploadInProgress || delayAfterUpload) ? (\r\n              <ImageFromFile\r\n                id={profileImage.id}\r\n                className={errorClasses}\r\n                rootClassName={css.uploadingImage}\r\n                aspectRatioClassName={css.squareAspectRatio}\r\n                file={profileImage.file}\r\n              >\r\n                {uploadingOverlay}\r\n              </ImageFromFile>\r\n            ) : null;\r\n\r\n          // Avatar is rendered in hidden during the upload delay\r\n          // Upload delay smoothes image change process:\r\n          // responsive img has time to load srcset stuff before it is shown to user.\r\n          const avatarClasses = classNames(errorClasses, css.avatar, {\r\n            [css.avatarInvisible]: this.state.uploadDelay,\r\n          });\r\n          const avatarComponent =\r\n            !fileUploadInProgress && profileImage.imageId ? (\r\n              <Avatar\r\n                className={avatarClasses}\r\n                renderSizes=\"(max-width: 767px) 96px, 240px\"\r\n                user={transientUser}\r\n                disableProfileLink\r\n              />\r\n            ) : null;\r\n\r\n          const chooseAvatarLabel =\r\n            profileImage.imageId || fileUploadInProgress ? (\r\n              <div className={css.avatarContainer}>\r\n                {imageFromFile}\r\n                {avatarComponent}\r\n                <div className={css.changeAvatar}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.changeAvatar\" />\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className={css.avatarPlaceholder}>\r\n                <div className={css.avatarPlaceholderText}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.addYourProfilePicture\" />\r\n                </div>\r\n                <div className={css.avatarPlaceholderTextMobile}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.addYourProfilePictureMobile\" />\r\n                </div>\r\n              </div>\r\n            );\r\n\r\n          const submitError = updateProfileError ? (\r\n            <div className={css.error}>\r\n              <FormattedMessage id=\"ProfileSettingsForm.updateProfileFailed\" />\r\n            </div>\r\n          ) : null;\r\n\r\n          const classes = classNames(rootClassName || css.root, className);\r\n          const submitInProgress = updateInProgress;\r\n          const submittedOnce = Object.keys(this.submittedValues).length > 0;\r\n          const pristineSinceLastSubmit = submittedOnce && isEqual(values, this.submittedValues);\r\n          const submitDisabled =\r\n            invalid || pristine || pristineSinceLastSubmit || uploadInProgress || submitInProgress;\r\n\r\n          return (\r\n            <Form\r\n              className={classes}\r\n              onSubmit={e => {\r\n                this.submittedValues = values;\r\n                handleSubmit(e);\r\n              }}\r\n            >\r\n              <div className={css.sectionContainer}>\r\n                <h3 className={css.sectionTitle}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.yourProfilePicture\" />\r\n                </h3>\r\n                <Field\r\n                  accept={ACCEPT_IMAGES}\r\n                  id=\"profileImage\"\r\n                  name=\"profileImage\"\r\n                  label={chooseAvatarLabel}\r\n                  type=\"file\"\r\n                  form={null}\r\n                  uploadImageError={uploadImageError}\r\n                  disabled={uploadInProgress}\r\n                >\r\n                  {fieldProps => {\r\n                    const { accept, id, input, label, disabled, uploadImageError } = fieldProps;\r\n                    const { name, type } = input;\r\n                    const onChange = e => {\r\n                      const file = e.target.files[0];\r\n                      form.change(`profileImage`, file);\r\n                      form.blur(`profileImage`);\r\n                      if (file != null) {\r\n                        const tempId = `${file.name}_${Date.now()}`;\r\n                        onImageUpload({ id: tempId, file });\r\n                      }\r\n                    };\r\n\r\n                    let error = null;\r\n\r\n                    if (isUploadImageOverLimitError(uploadImageError)) {\r\n                      error = (\r\n                        <div className={css.error}>\r\n                          <FormattedMessage id=\"ProfileSettingsForm.imageUploadFailedFileTooLarge\" />\r\n                        </div>\r\n                      );\r\n                    } else if (uploadImageError) {\r\n                      error = (\r\n                        <div className={css.error}>\r\n                          <FormattedMessage id=\"ProfileSettingsForm.imageUploadFailed\" />\r\n                        </div>\r\n                      );\r\n                    }\r\n\r\n                    return (\r\n                      <div className={css.uploadAvatarWrapper}>\r\n                        <label className={css.label} htmlFor={id}>\r\n                          {label}\r\n                        </label>\r\n                        <input\r\n                          accept={accept}\r\n                          id={id}\r\n                          name={name}\r\n                          className={css.uploadAvatarInput}\r\n                          disabled={disabled}\r\n                          onChange={onChange}\r\n                          type={type}\r\n                        />\r\n                        {error}\r\n                      </div>\r\n                    );\r\n                  }}\r\n                </Field>\r\n                <div className={css.tip}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.tip\" />\r\n                </div>\r\n                <div className={css.fileInfo}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.fileInfo\" />\r\n                </div>\r\n              </div>\r\n              <div className={css.sectionContainer}>\r\n                <h3 className={css.sectionTitle}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.yourName\" />\r\n                </h3>\r\n                <div className={css.nameContainer}>\r\n                  <FieldTextInput\r\n                    className={css.firstName}\r\n                    type=\"text\"\r\n                    id=\"firstName\"\r\n                    name=\"firstName\"\r\n                    label={firstNameLabel}\r\n                    placeholder={firstNamePlaceholder}\r\n                    validate={firstNameRequired}\r\n                  />\r\n                  <FieldTextInput\r\n                    className={css.lastName}\r\n                    type=\"text\"\r\n                    id=\"lastName\"\r\n                    name=\"lastName\"\r\n                    label={lastNameLabel}\r\n                    placeholder={lastNamePlaceholder}\r\n                    validate={lastNameRequired}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className={classNames(css.sectionContainer, css.lastSection)}>\r\n                <h3 className={css.sectionTitle}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.bioHeading\" />\r\n                </h3>\r\n                <FieldTextInput\r\n                  type=\"textarea\"\r\n                  id=\"bio\"\r\n                  name=\"bio\"\r\n                  label={bioLabel}\r\n                  placeholder={bioPlaceholder}\r\n                />\r\n                <p className={css.bioInfo}>\r\n                  <FormattedMessage id=\"ProfileSettingsForm.bioInfo\" />\r\n                </p>\r\n              </div>\r\n              {submitError}\r\n              <Button\r\n                className={css.submitButton}\r\n                type=\"submit\"\r\n                inProgress={submitInProgress}\r\n                disabled={submitDisabled}\r\n                ready={pristineSinceLastSubmit}\r\n              >\r\n                <FormattedMessage id=\"ProfileSettingsForm.saveChanges\" />\r\n              </Button>\r\n            </Form>\r\n          );\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nProfileSettingsFormComponent.defaultProps = {\r\n  rootClassName: null,\r\n  className: null,\r\n  uploadImageError: null,\r\n  updateProfileError: null,\r\n  updateProfileReady: false,\r\n};\r\n\r\nProfileSettingsFormComponent.propTypes = {\r\n  rootClassName: string,\r\n  className: string,\r\n\r\n  uploadImageError: propTypes.error,\r\n  uploadInProgress: bool.isRequired,\r\n  updateInProgress: bool.isRequired,\r\n  updateProfileError: propTypes.error,\r\n  updateProfileReady: bool,\r\n\r\n  // from injectIntl\r\n  intl: intlShape.isRequired,\r\n};\r\n\r\nconst ProfileSettingsForm = compose(injectIntl)(ProfileSettingsFormComponent);\r\n\r\nProfileSettingsForm.displayName = 'ProfileSettingsForm';\r\n\r\nexport default ProfileSettingsForm;\r\n"]},"metadata":{},"sourceType":"module"}