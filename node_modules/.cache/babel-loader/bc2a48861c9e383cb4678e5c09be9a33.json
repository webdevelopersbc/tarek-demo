{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amardeep\\\\tarek_project\\\\ftw-product\\\\src\\\\components\\\\ModalMissingInformation\\\\ModalMissingInformation.js\";\nimport React, { Component } from 'react';\nimport { bool, func, string } from 'prop-types';\nimport { FormattedMessage } from '../../util/reactIntl';\nimport classNames from 'classnames';\nimport routeConfiguration from '../../routing/routeConfiguration';\nimport { ensureCurrentUser } from '../../util/data';\nimport { propTypes } from '../../util/types';\nimport { pathByRouteName } from '../../util/routes';\nimport { Modal } from '../../components';\nimport EmailReminder from './EmailReminder';\nimport StripeAccountReminder from './StripeAccountReminder';\nimport css from './ModalMissingInformation.module.css';\nconst MISSING_INFORMATION_MODAL_WHITELIST = ['LoginPage', 'SignupPage', 'ContactDetailsPage', 'EmailVerificationPage', 'PasswordResetPage', 'StripePayoutPage'];\nconst EMAIL_VERIFICATION = 'EMAIL_VERIFICATION';\nconst STRIPE_ACCOUNT = 'STRIPE_ACCOUNT';\n\nclass ModalMissingInformation extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showMissingInformationReminder: null,\n      hasSeenMissingInformationReminder: false\n    };\n    this.handleMissingInformationReminder = this.handleMissingInformationReminder.bind(this);\n  }\n\n  componentDidUpdate() {\n    const {\n      currentUser,\n      currentUserHasListings,\n      currentUserHasOrders,\n      location\n    } = this.props;\n    const user = ensureCurrentUser(currentUser);\n    this.handleMissingInformationReminder(user, currentUserHasListings, currentUserHasOrders, location);\n  }\n\n  handleMissingInformationReminder(currentUser, currentUserHasListings, currentUserHasOrders, newLocation) {\n    const routes = routeConfiguration();\n    const whitelistedPaths = MISSING_INFORMATION_MODAL_WHITELIST.map(page => pathByRouteName(page, routes)); // Is the current page whitelisted?\n\n    const isPageWhitelisted = whitelistedPaths.includes(newLocation.pathname); // Track if path changes inside Page level component\n\n    const pathChanged = newLocation.pathname !== this.props.location.pathname;\n    const notRemindedYet = !this.state.showMissingInformationReminder && !this.state.hasSeenMissingInformationReminder; // Is the reminder already shown on current page\n\n    const showOnPathChange = notRemindedYet || pathChanged;\n\n    if (!isPageWhitelisted && showOnPathChange) {\n      // Emails are sent when order is initiated\n      // Customer is likely to get email soon when she books something\n      // Provider email should work - she should get an email when someone books a listing\n      const hasOrders = currentUserHasOrders === true;\n      const hasListingsOrOrders = currentUserHasListings || hasOrders;\n      const emailUnverified = !!currentUser.id && !currentUser.attributes.emailVerified;\n      const emailVerificationNeeded = hasListingsOrOrders && emailUnverified;\n      const stripeAccountMissing = !!currentUser.id && !currentUser.attributes.stripeConnected;\n      const stripeAccountNeeded = currentUserHasListings && stripeAccountMissing; // Show reminder\n\n      if (emailVerificationNeeded) {\n        this.setState({\n          showMissingInformationReminder: EMAIL_VERIFICATION\n        });\n      } else if (stripeAccountNeeded) {\n        this.setState({\n          showMissingInformationReminder: STRIPE_ACCOUNT\n        });\n      }\n    }\n  }\n\n  render() {\n    const {\n      rootClassName,\n      className,\n      containerClassName,\n      currentUser,\n      sendVerificationEmailInProgress,\n      sendVerificationEmailError,\n      onManageDisableScrolling,\n      onResendVerificationEmail\n    } = this.props;\n    const user = ensureCurrentUser(currentUser);\n    const classes = classNames(rootClassName || css.root, className);\n    let content = null;\n    const currentUserLoaded = user && user.id;\n\n    if (currentUserLoaded) {\n      if (this.state.showMissingInformationReminder === EMAIL_VERIFICATION) {\n        content = /*#__PURE__*/React.createElement(EmailReminder, {\n          className: classes,\n          user: user,\n          onResendVerificationEmail: onResendVerificationEmail,\n          sendVerificationEmailInProgress: sendVerificationEmailInProgress,\n          sendVerificationEmailError: sendVerificationEmailError,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 11\n          }\n        });\n      } else if (this.state.showMissingInformationReminder === STRIPE_ACCOUNT) {\n        content = /*#__PURE__*/React.createElement(StripeAccountReminder, {\n          className: classes,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 19\n          }\n        });\n      }\n    }\n\n    const closeButtonMessage = /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"ModalMissingInformation.closeVerifyEmailReminder\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 7\n      }\n    });\n    return /*#__PURE__*/React.createElement(Modal, {\n      id: \"MissingInformationReminder\",\n      containerClassName: containerClassName,\n      isOpen: !!this.state.showMissingInformationReminder,\n      onClose: () => {\n        this.setState({\n          showMissingInformationReminder: null,\n          hasSeenMissingInformationReminder: true\n        });\n      },\n      usePortal: true,\n      onManageDisableScrolling: onManageDisableScrolling,\n      closeButtonMessage: closeButtonMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 7\n      }\n    }, content);\n  }\n\n}\n\nModalMissingInformation.defaultProps = {\n  className: null,\n  rootClassName: null,\n  currentUser: null\n};\nModalMissingInformation.propTypes = {\n  id: string.isRequired,\n  className: string,\n  rootClassName: string,\n  containerClassName: string,\n  currentUser: propTypes.currentUser,\n  onManageDisableScrolling: func.isRequired,\n  sendVerificationEmailError: propTypes.error,\n  sendVerificationEmailInProgress: bool.isRequired\n};\nModalMissingInformation.displayName = 'ModalMissingInformation';\nexport default ModalMissingInformation;","map":{"version":3,"sources":["D:/Amardeep/tarek_project/ftw-product/src/components/ModalMissingInformation/ModalMissingInformation.js"],"names":["React","Component","bool","func","string","FormattedMessage","classNames","routeConfiguration","ensureCurrentUser","propTypes","pathByRouteName","Modal","EmailReminder","StripeAccountReminder","css","MISSING_INFORMATION_MODAL_WHITELIST","EMAIL_VERIFICATION","STRIPE_ACCOUNT","ModalMissingInformation","constructor","props","state","showMissingInformationReminder","hasSeenMissingInformationReminder","handleMissingInformationReminder","bind","componentDidUpdate","currentUser","currentUserHasListings","currentUserHasOrders","location","user","newLocation","routes","whitelistedPaths","map","page","isPageWhitelisted","includes","pathname","pathChanged","notRemindedYet","showOnPathChange","hasOrders","hasListingsOrOrders","emailUnverified","id","attributes","emailVerified","emailVerificationNeeded","stripeAccountMissing","stripeConnected","stripeAccountNeeded","setState","render","rootClassName","className","containerClassName","sendVerificationEmailInProgress","sendVerificationEmailError","onManageDisableScrolling","onResendVerificationEmail","classes","root","content","currentUserLoaded","closeButtonMessage","defaultProps","isRequired","error","displayName"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { bool, func, string } from 'prop-types';\r\nimport { FormattedMessage } from '../../util/reactIntl';\r\nimport classNames from 'classnames';\r\nimport routeConfiguration from '../../routing/routeConfiguration';\r\nimport { ensureCurrentUser } from '../../util/data';\r\nimport { propTypes } from '../../util/types';\r\nimport { pathByRouteName } from '../../util/routes';\r\nimport { Modal } from '../../components';\r\n\r\nimport EmailReminder from './EmailReminder';\r\nimport StripeAccountReminder from './StripeAccountReminder';\r\nimport css from './ModalMissingInformation.module.css';\r\n\r\nconst MISSING_INFORMATION_MODAL_WHITELIST = [\r\n  'LoginPage',\r\n  'SignupPage',\r\n  'ContactDetailsPage',\r\n  'EmailVerificationPage',\r\n  'PasswordResetPage',\r\n  'StripePayoutPage',\r\n];\r\n\r\nconst EMAIL_VERIFICATION = 'EMAIL_VERIFICATION';\r\nconst STRIPE_ACCOUNT = 'STRIPE_ACCOUNT';\r\n\r\nclass ModalMissingInformation extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showMissingInformationReminder: null,\r\n      hasSeenMissingInformationReminder: false,\r\n    };\r\n    this.handleMissingInformationReminder = this.handleMissingInformationReminder.bind(this);\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const { currentUser, currentUserHasListings, currentUserHasOrders, location } = this.props;\r\n    const user = ensureCurrentUser(currentUser);\r\n    this.handleMissingInformationReminder(\r\n      user,\r\n      currentUserHasListings,\r\n      currentUserHasOrders,\r\n      location\r\n    );\r\n  }\r\n\r\n  handleMissingInformationReminder(\r\n    currentUser,\r\n    currentUserHasListings,\r\n    currentUserHasOrders,\r\n    newLocation\r\n  ) {\r\n    const routes = routeConfiguration();\r\n    const whitelistedPaths = MISSING_INFORMATION_MODAL_WHITELIST.map(page =>\r\n      pathByRouteName(page, routes)\r\n    );\r\n\r\n    // Is the current page whitelisted?\r\n    const isPageWhitelisted = whitelistedPaths.includes(newLocation.pathname);\r\n\r\n    // Track if path changes inside Page level component\r\n    const pathChanged = newLocation.pathname !== this.props.location.pathname;\r\n    const notRemindedYet =\r\n      !this.state.showMissingInformationReminder && !this.state.hasSeenMissingInformationReminder;\r\n\r\n    // Is the reminder already shown on current page\r\n    const showOnPathChange = notRemindedYet || pathChanged;\r\n\r\n    if (!isPageWhitelisted && showOnPathChange) {\r\n      // Emails are sent when order is initiated\r\n      // Customer is likely to get email soon when she books something\r\n      // Provider email should work - she should get an email when someone books a listing\r\n      const hasOrders = currentUserHasOrders === true;\r\n      const hasListingsOrOrders = currentUserHasListings || hasOrders;\r\n\r\n      const emailUnverified = !!currentUser.id && !currentUser.attributes.emailVerified;\r\n      const emailVerificationNeeded = hasListingsOrOrders && emailUnverified;\r\n\r\n      const stripeAccountMissing = !!currentUser.id && !currentUser.attributes.stripeConnected;\r\n      const stripeAccountNeeded = currentUserHasListings && stripeAccountMissing;\r\n\r\n      // Show reminder\r\n      if (emailVerificationNeeded) {\r\n        this.setState({ showMissingInformationReminder: EMAIL_VERIFICATION });\r\n      } else if (stripeAccountNeeded) {\r\n        this.setState({ showMissingInformationReminder: STRIPE_ACCOUNT });\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      rootClassName,\r\n      className,\r\n      containerClassName,\r\n      currentUser,\r\n      sendVerificationEmailInProgress,\r\n      sendVerificationEmailError,\r\n      onManageDisableScrolling,\r\n      onResendVerificationEmail,\r\n    } = this.props;\r\n\r\n    const user = ensureCurrentUser(currentUser);\r\n    const classes = classNames(rootClassName || css.root, className);\r\n\r\n    let content = null;\r\n\r\n    const currentUserLoaded = user && user.id;\r\n    if (currentUserLoaded) {\r\n      if (this.state.showMissingInformationReminder === EMAIL_VERIFICATION) {\r\n        content = (\r\n          <EmailReminder\r\n            className={classes}\r\n            user={user}\r\n            onResendVerificationEmail={onResendVerificationEmail}\r\n            sendVerificationEmailInProgress={sendVerificationEmailInProgress}\r\n            sendVerificationEmailError={sendVerificationEmailError}\r\n          />\r\n        );\r\n      } else if (this.state.showMissingInformationReminder === STRIPE_ACCOUNT) {\r\n        content = <StripeAccountReminder className={classes} />;\r\n      }\r\n    }\r\n\r\n    const closeButtonMessage = (\r\n      <FormattedMessage id=\"ModalMissingInformation.closeVerifyEmailReminder\" />\r\n    );\r\n\r\n    return (\r\n      <Modal\r\n        id=\"MissingInformationReminder\"\r\n        containerClassName={containerClassName}\r\n        isOpen={!!this.state.showMissingInformationReminder}\r\n        onClose={() => {\r\n          this.setState({\r\n            showMissingInformationReminder: null,\r\n            hasSeenMissingInformationReminder: true,\r\n          });\r\n        }}\r\n        usePortal\r\n        onManageDisableScrolling={onManageDisableScrolling}\r\n        closeButtonMessage={closeButtonMessage}\r\n      >\r\n        {content}\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nModalMissingInformation.defaultProps = {\r\n  className: null,\r\n  rootClassName: null,\r\n  currentUser: null,\r\n};\r\n\r\nModalMissingInformation.propTypes = {\r\n  id: string.isRequired,\r\n  className: string,\r\n  rootClassName: string,\r\n  containerClassName: string,\r\n\r\n  currentUser: propTypes.currentUser,\r\n  onManageDisableScrolling: func.isRequired,\r\n  sendVerificationEmailError: propTypes.error,\r\n  sendVerificationEmailInProgress: bool.isRequired,\r\n};\r\n\r\nModalMissingInformation.displayName = 'ModalMissingInformation';\r\n\r\nexport default ModalMissingInformation;\r\n"]},"metadata":{},"sourceType":"module"}