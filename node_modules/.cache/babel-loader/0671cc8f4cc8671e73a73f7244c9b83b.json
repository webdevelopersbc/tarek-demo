{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amardeep\\\\tarek_project\\\\ftw-product\\\\src\\\\containers\\\\EditListingPage\\\\EditListingWizard\\\\EditListingDeliveryPanel\\\\EditListingDeliveryPanel.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames'; // Import configs and util modules\n\nimport config from '../../../../config';\nimport { FormattedMessage } from '../../../../util/reactIntl';\nimport { LISTING_STATE_DRAFT } from '../../../../util/types';\nimport { ensureOwnListing } from '../../../../util/data';\nimport { types as sdkTypes } from '../../../../util/sdkLoader'; // Import shared components\n\nimport { ListingLink } from '../../../../components'; // Import modules from this directory\n\nimport EditListingDeliveryForm from './EditListingDeliveryForm';\nimport css from './EditListingDeliveryPanel.module.css';\nconst {\n  Money\n} = sdkTypes;\n\nclass EditListingDeliveryPanel extends Component {\n  constructor(props) {\n    super(props);\n    this.getInitialValues = this.getInitialValues.bind(this);\n    this.state = {\n      initialValues: this.getInitialValues()\n    };\n  }\n\n  getInitialValues() {\n    var _publicData$location;\n\n    const {\n      listing\n    } = this.props;\n    const currentListing = ensureOwnListing(listing);\n    const {\n      geolocation,\n      publicData,\n      price\n    } = currentListing.attributes; // Only render current search if full place object is available in the URL params\n    // TODO bounds are missing - those need to be queried directly from Google Places\n\n    const locationFieldsPresent = (publicData === null || publicData === void 0 ? void 0 : (_publicData$location = publicData.location) === null || _publicData$location === void 0 ? void 0 : _publicData$location.address) && geolocation;\n    const location = (publicData === null || publicData === void 0 ? void 0 : publicData.location) ? publicData.location : {};\n    const {\n      address,\n      building\n    } = location;\n    const {\n      shippingEnabled,\n      pickupEnabled,\n      shippingPriceInSubunitsOneItem,\n      shippingPriceInSubunitsAdditionalItems\n    } = publicData;\n    const deliveryOptions = [];\n\n    if (shippingEnabled) {\n      deliveryOptions.push('shipping');\n    }\n\n    if (pickupEnabled) {\n      deliveryOptions.push('pickup');\n    }\n\n    const currency = (price === null || price === void 0 ? void 0 : price.currency) || config.currency;\n    const shippingOneItemAsMoney = shippingPriceInSubunitsOneItem ? new Money(shippingPriceInSubunitsOneItem, currency) : null;\n    const shippingAdditionalItemsAsMoney = shippingPriceInSubunitsAdditionalItems ? new Money(shippingPriceInSubunitsAdditionalItems, currency) : null;\n    return {\n      building,\n      location: locationFieldsPresent ? {\n        search: address,\n        selectedPlace: {\n          address,\n          origin: geolocation\n        }\n      } : {\n        search: undefined,\n        selectedPlace: undefined\n      },\n      deliveryOptions,\n      shippingPriceInSubunitsOneItem: shippingOneItemAsMoney,\n      shippingPriceInSubunitsAdditionalItems: shippingAdditionalItemsAsMoney\n    };\n  }\n\n  render() {\n    const {\n      className,\n      rootClassName,\n      listing,\n      disabled,\n      ready,\n      onSubmit,\n      onChange,\n      submitButtonText,\n      panelUpdated,\n      updateInProgress,\n      errors\n    } = this.props;\n    const classes = classNames(rootClassName || css.root, className);\n    const currentListing = ensureOwnListing(listing);\n    const isPublished = currentListing.id && currentListing.attributes.state !== LISTING_STATE_DRAFT;\n    const panelTitle = isPublished ? /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"EditListingDeliveryPanel.title\",\n      values: {\n        listingTitle: /*#__PURE__*/React.createElement(ListingLink, {\n          listing: listing,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 33\n          }\n        })\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 7\n      }\n    }) : /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"EditListingDeliveryPanel.createListingTitle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 7\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: css.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }\n    }, panelTitle), /*#__PURE__*/React.createElement(EditListingDeliveryForm, {\n      className: css.form,\n      initialValues: this.state.initialValues,\n      onSubmit: values => {\n        var _location$selectedPla, _location$selectedPla2;\n\n        const {\n          building = '',\n          location,\n          shippingPriceInSubunitsOneItem,\n          shippingPriceInSubunitsAdditionalItems,\n          deliveryOptions\n        } = values;\n        const shippingEnabled = deliveryOptions.includes('shipping');\n        const pickupEnabled = deliveryOptions.includes('pickup');\n        const address = (location === null || location === void 0 ? void 0 : (_location$selectedPla = location.selectedPlace) === null || _location$selectedPla === void 0 ? void 0 : _location$selectedPla.address) || null;\n        const origin = (location === null || location === void 0 ? void 0 : (_location$selectedPla2 = location.selectedPlace) === null || _location$selectedPla2 === void 0 ? void 0 : _location$selectedPla2.origin) || null;\n        const pickupDataMaybe = pickupEnabled && address ? {\n          location: {\n            address,\n            building\n          }\n        } : {};\n        const shippingDataMaybe = shippingEnabled && shippingPriceInSubunitsOneItem ? {\n          // Note: we only save the \"amount\" because currency should not differ from listing's price.\n          // Money is always dealt in subunits (e.g. cents) to avoid float calculations.\n          shippingPriceInSubunitsOneItem: shippingPriceInSubunitsOneItem.amount,\n          shippingPriceInSubunitsAdditionalItems: shippingPriceInSubunitsAdditionalItems === null || shippingPriceInSubunitsAdditionalItems === void 0 ? void 0 : shippingPriceInSubunitsAdditionalItems.amount\n        } : {};\n        const updateValues = {\n          geolocation: origin,\n          publicData: {\n            pickupEnabled,\n            ...pickupDataMaybe,\n            shippingEnabled,\n            ...shippingDataMaybe\n          }\n        };\n        this.setState({\n          initialValues: {\n            building,\n            location: {\n              search: address,\n              selectedPlace: {\n                address,\n                origin\n              }\n            },\n            shippingPriceInSubunitsOneItem,\n            shippingPriceInSubunitsAdditionalItems,\n            deliveryOptions\n          }\n        });\n        onSubmit(updateValues);\n      },\n      onChange: onChange,\n      saveActionMsg: submitButtonText,\n      disabled: disabled,\n      ready: ready,\n      updated: panelUpdated,\n      updateInProgress: updateInProgress,\n      fetchErrors: errors,\n      autoFocus: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nconst {\n  func,\n  object,\n  string,\n  bool\n} = PropTypes;\nEditListingDeliveryPanel.defaultProps = {\n  className: null,\n  rootClassName: null,\n  listing: null\n};\nEditListingDeliveryPanel.propTypes = {\n  className: string,\n  rootClassName: string,\n  // We cannot use propTypes.listing since the listing might be a draft.\n  listing: object,\n  disabled: bool.isRequired,\n  ready: bool.isRequired,\n  onSubmit: func.isRequired,\n  onChange: func.isRequired,\n  submitButtonText: string.isRequired,\n  panelUpdated: bool.isRequired,\n  updateInProgress: bool.isRequired,\n  errors: object.isRequired\n};\nexport default EditListingDeliveryPanel;","map":{"version":3,"sources":["D:/Amardeep/tarek_project/ftw-product/src/containers/EditListingPage/EditListingWizard/EditListingDeliveryPanel/EditListingDeliveryPanel.js"],"names":["React","Component","PropTypes","classNames","config","FormattedMessage","LISTING_STATE_DRAFT","ensureOwnListing","types","sdkTypes","ListingLink","EditListingDeliveryForm","css","Money","EditListingDeliveryPanel","constructor","props","getInitialValues","bind","state","initialValues","listing","currentListing","geolocation","publicData","price","attributes","locationFieldsPresent","location","address","building","shippingEnabled","pickupEnabled","shippingPriceInSubunitsOneItem","shippingPriceInSubunitsAdditionalItems","deliveryOptions","push","currency","shippingOneItemAsMoney","shippingAdditionalItemsAsMoney","search","selectedPlace","origin","undefined","render","className","rootClassName","disabled","ready","onSubmit","onChange","submitButtonText","panelUpdated","updateInProgress","errors","classes","root","isPublished","id","panelTitle","listingTitle","title","form","values","includes","pickupDataMaybe","shippingDataMaybe","amount","updateValues","setState","func","object","string","bool","defaultProps","propTypes","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\n\r\n// Import configs and util modules\r\nimport config from '../../../../config';\r\nimport { FormattedMessage } from '../../../../util/reactIntl';\r\nimport { LISTING_STATE_DRAFT } from '../../../../util/types';\r\nimport { ensureOwnListing } from '../../../../util/data';\r\nimport { types as sdkTypes } from '../../../../util/sdkLoader';\r\n\r\n// Import shared components\r\nimport { ListingLink } from '../../../../components';\r\n\r\n// Import modules from this directory\r\nimport EditListingDeliveryForm from './EditListingDeliveryForm';\r\nimport css from './EditListingDeliveryPanel.module.css';\r\n\r\nconst { Money } = sdkTypes;\r\n\r\nclass EditListingDeliveryPanel extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.getInitialValues = this.getInitialValues.bind(this);\r\n\r\n    this.state = {\r\n      initialValues: this.getInitialValues(),\r\n    };\r\n  }\r\n\r\n  getInitialValues() {\r\n    const { listing } = this.props;\r\n    const currentListing = ensureOwnListing(listing);\r\n    const { geolocation, publicData, price } = currentListing.attributes;\r\n\r\n    // Only render current search if full place object is available in the URL params\r\n    // TODO bounds are missing - those need to be queried directly from Google Places\r\n    const locationFieldsPresent = publicData?.location?.address && geolocation;\r\n    const location = publicData?.location ? publicData.location : {};\r\n    const { address, building } = location;\r\n    const {\r\n      shippingEnabled,\r\n      pickupEnabled,\r\n      shippingPriceInSubunitsOneItem,\r\n      shippingPriceInSubunitsAdditionalItems,\r\n    } = publicData;\r\n    const deliveryOptions = [];\r\n\r\n    if (shippingEnabled) {\r\n      deliveryOptions.push('shipping');\r\n    }\r\n    if (pickupEnabled) {\r\n      deliveryOptions.push('pickup');\r\n    }\r\n\r\n    const currency = price?.currency || config.currency;\r\n    const shippingOneItemAsMoney = shippingPriceInSubunitsOneItem\r\n      ? new Money(shippingPriceInSubunitsOneItem, currency)\r\n      : null;\r\n    const shippingAdditionalItemsAsMoney = shippingPriceInSubunitsAdditionalItems\r\n      ? new Money(shippingPriceInSubunitsAdditionalItems, currency)\r\n      : null;\r\n    return {\r\n      building,\r\n      location: locationFieldsPresent\r\n        ? {\r\n            search: address,\r\n            selectedPlace: { address, origin: geolocation },\r\n          }\r\n        : { search: undefined, selectedPlace: undefined },\r\n      deliveryOptions,\r\n      shippingPriceInSubunitsOneItem: shippingOneItemAsMoney,\r\n      shippingPriceInSubunitsAdditionalItems: shippingAdditionalItemsAsMoney,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      className,\r\n      rootClassName,\r\n      listing,\r\n      disabled,\r\n      ready,\r\n      onSubmit,\r\n      onChange,\r\n      submitButtonText,\r\n      panelUpdated,\r\n      updateInProgress,\r\n      errors,\r\n    } = this.props;\r\n\r\n    const classes = classNames(rootClassName || css.root, className);\r\n    const currentListing = ensureOwnListing(listing);\r\n\r\n    const isPublished =\r\n      currentListing.id && currentListing.attributes.state !== LISTING_STATE_DRAFT;\r\n    const panelTitle = isPublished ? (\r\n      <FormattedMessage\r\n        id=\"EditListingDeliveryPanel.title\"\r\n        values={{ listingTitle: <ListingLink listing={listing} /> }}\r\n      />\r\n    ) : (\r\n      <FormattedMessage id=\"EditListingDeliveryPanel.createListingTitle\" />\r\n    );\r\n\r\n    return (\r\n      <div className={classes}>\r\n        <h1 className={css.title}>{panelTitle}</h1>\r\n        <EditListingDeliveryForm\r\n          className={css.form}\r\n          initialValues={this.state.initialValues}\r\n          onSubmit={values => {\r\n            const {\r\n              building = '',\r\n              location,\r\n              shippingPriceInSubunitsOneItem,\r\n              shippingPriceInSubunitsAdditionalItems,\r\n              deliveryOptions,\r\n            } = values;\r\n\r\n            const shippingEnabled = deliveryOptions.includes('shipping');\r\n            const pickupEnabled = deliveryOptions.includes('pickup');\r\n            const address = location?.selectedPlace?.address || null;\r\n            const origin = location?.selectedPlace?.origin || null;\r\n\r\n            const pickupDataMaybe =\r\n              pickupEnabled && address ? { location: { address, building } } : {};\r\n\r\n            const shippingDataMaybe =\r\n              shippingEnabled && shippingPriceInSubunitsOneItem\r\n                ? {\r\n                    // Note: we only save the \"amount\" because currency should not differ from listing's price.\r\n                    // Money is always dealt in subunits (e.g. cents) to avoid float calculations.\r\n                    shippingPriceInSubunitsOneItem: shippingPriceInSubunitsOneItem.amount,\r\n                    shippingPriceInSubunitsAdditionalItems:\r\n                      shippingPriceInSubunitsAdditionalItems?.amount,\r\n                  }\r\n                : {};\r\n\r\n            const updateValues = {\r\n              geolocation: origin,\r\n              publicData: {\r\n                pickupEnabled,\r\n                ...pickupDataMaybe,\r\n                shippingEnabled,\r\n                ...shippingDataMaybe,\r\n              },\r\n            };\r\n            this.setState({\r\n              initialValues: {\r\n                building,\r\n                location: { search: address, selectedPlace: { address, origin } },\r\n                shippingPriceInSubunitsOneItem,\r\n                shippingPriceInSubunitsAdditionalItems,\r\n                deliveryOptions,\r\n              },\r\n            });\r\n            onSubmit(updateValues);\r\n          }}\r\n          onChange={onChange}\r\n          saveActionMsg={submitButtonText}\r\n          disabled={disabled}\r\n          ready={ready}\r\n          updated={panelUpdated}\r\n          updateInProgress={updateInProgress}\r\n          fetchErrors={errors}\r\n          autoFocus\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst { func, object, string, bool } = PropTypes;\r\n\r\nEditListingDeliveryPanel.defaultProps = {\r\n  className: null,\r\n  rootClassName: null,\r\n  listing: null,\r\n};\r\n\r\nEditListingDeliveryPanel.propTypes = {\r\n  className: string,\r\n  rootClassName: string,\r\n\r\n  // We cannot use propTypes.listing since the listing might be a draft.\r\n  listing: object,\r\n\r\n  disabled: bool.isRequired,\r\n  ready: bool.isRequired,\r\n  onSubmit: func.isRequired,\r\n  onChange: func.isRequired,\r\n  submitButtonText: string.isRequired,\r\n  panelUpdated: bool.isRequired,\r\n  updateInProgress: bool.isRequired,\r\n  errors: object.isRequired,\r\n};\r\n\r\nexport default EditListingDeliveryPanel;\r\n"]},"metadata":{},"sourceType":"module"}